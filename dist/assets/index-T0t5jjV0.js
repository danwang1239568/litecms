import{aL as J,c as $e,A as ke,au as ze,B as Te,s as me,bf as Ve,u as Se,f as b,an as pe,w as le,bg as Re,al as He,bh as De,am as Ne,b3 as ee,L as K,K as Ke,b as Fe,d as ve,e as Ie,H as E,m as ie,ao as Ue,_ as Ye,E as We,bi as Xe,bj as je,r as P,af as qe,bk as ge,bl as he,bm as ye,aB as re,q as ce,aG as Ge,G as $,o as m,j as y,k as v,ap as ne,S as g,p as c,n as be,T as j,g as oe,l as q,Q as z,Z as N,aR as G,a7 as te,aq as se,ak as Ze,bn as Le,z as Je,aJ as Qe,bo as Oe,bp as Ce,bq as Ee}from"./index-eNiykY21.js";import{E as xe}from"./el-button-DHmMqvAQ.js";import{E as _e}from"./el-input-BZXojDKh.js";import{P as ae}from"./vnode-Cg2N9g-p.js";import{o as we,E as en}from"./focus-trap-DYYne7mO.js";import{t as nn,u as Be}from"./constants-Bb7TdvhW.js";let Z;const on=e=>{var n;if(!J)return 0;if(Z!==void 0)return Z;const t=document.createElement("div");t.className=`${e}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const s=t.offsetWidth;t.style.overflow="scroll";const a=document.createElement("div");a.style.width="100%",t.appendChild(a);const l=a.offsetWidth;return(n=t.parentNode)==null||n.removeChild(t),Z=s-l,Z};function Ln(e,n){if(!J)return;if(!n){e.scrollTop=0;return}const t=[];let s=n.offsetParent;for(;s!==null&&e!==s&&e.contains(s);)t.push(s),s=s.offsetParent;const a=n.offsetTop+t.reduce((d,o)=>d+o.offsetTop,0),l=a+n.offsetHeight,i=e.scrollTop,u=i+e.clientHeight;a<i?e.scrollTop=a:l>u&&(e.scrollTop=l-e.clientHeight)}const tn=e=>["",...$e].includes(e),sn=(e,n,t,s)=>{let a={offsetX:0,offsetY:0};const l=o=>{const w=o.clientX,R=o.clientY,{offsetX:f,offsetY:H}=a,I=e.value.getBoundingClientRect(),p=I.left,D=I.top,B=I.width,L=I.height,U=document.documentElement.clientWidth,Q=document.documentElement.clientHeight,x=-p+f,_=-D+H,M=U-p-B+f,Y=Q-D-L+H,W=k=>{let T=f+k.clientX-w,O=H+k.clientY-R;s!=null&&s.value||(T=Math.min(Math.max(T,x),M),O=Math.min(Math.max(O,_),Y)),a={offsetX:T,offsetY:O},e.value&&(e.value.style.transform=`translate(${me(T)}, ${me(O)})`)},X=()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",X)};document.addEventListener("mousemove",W),document.addEventListener("mouseup",X)},i=()=>{n.value&&e.value&&n.value.addEventListener("mousedown",l)},u=()=>{n.value&&e.value&&n.value.removeEventListener("mousedown",l)},d=()=>{a={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return ke(()=>{ze(()=>{t.value?i():u()})}),Te(()=>{u()}),{resetPosition:d}},an=(e,n={})=>{Ve(e)||nn("[useLockscreen]","You need to pass a ref param to this function");const t=n.ns||Se("popup"),s=b(()=>t.bm("parent","hidden"));if(!J||pe(document.body,s.value))return;let a=0,l=!1,i="0";const u=()=>{setTimeout(()=>{typeof document>"u"||(Ne(document==null?void 0:document.body,s.value),l&&document&&(document.body.style.width=i))},200)};le(e,d=>{if(!d){u();return}l=!pe(document.body,s.value),l&&(i=document.body.style.width),a=on(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,w=Re(document.body,"overflowY");a>0&&(o||w==="scroll")&&l&&(document.body.style.width=`calc(100% - ${a}px)`),He(document.body,s.value)}),De(()=>u())},Ae=e=>{if(!e)return{onClick:ee,onMousedown:ee,onMouseup:ee};let n=!1,t=!1;return{onClick:i=>{n&&t&&e(i),n=t=!1},onMousedown:i=>{n=i.target===i.currentTarget},onMouseup:i=>{t=i.target===i.currentTarget}}},ue="_trap-focus-children",S=[],Me=e=>{if(S.length===0)return;const n=S[S.length-1][ue];if(n.length>0&&e.code===Ke.tab){if(n.length===1){e.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const t=e.shiftKey,s=e.target===n[0],a=e.target===n[n.length-1];s&&t&&(e.preventDefault(),n[n.length-1].focus()),a&&!t&&(e.preventDefault(),n[0].focus())}},ln={beforeMount(e){e[ue]=we(e),S.push(e),S.length<=1&&document.addEventListener("keydown",Me)},updated(e){K(()=>{e[ue]=we(e)})},unmounted(){S.shift(),S.length===0&&document.removeEventListener("keydown",Me)}},rn=Fe({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:ve([String,Array,Object])},zIndex:{type:ve([String,Number])}}),un={click:e=>e instanceof MouseEvent},cn="overlay";var dn=Ie({name:"ElOverlay",props:rn,emits:un,setup(e,{slots:n,emit:t}){const s=Se(cn),a=d=>{t("click",d)},{onClick:l,onMousedown:i,onMouseup:u}=Ae(e.customMaskEvent?void 0:a);return()=>e.mask?E("div",{class:[s.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:l,onMousedown:i,onMouseup:u},[ie(n,"default")],ae.STYLE|ae.CLASS|ae.PROPS,["onClick","onMouseup","onMousedown"]):Ue("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[ie(n,"default")])}});const fn=dn,mn=Ie({name:"ElMessageBox",directives:{TrapFocus:ln},components:{ElButton:xe,ElFocusTrap:en,ElInput:_e,ElOverlay:fn,ElIcon:We,...Xe},inheritAttrs:!1,props:{buttonSize:{type:String,validator:tn},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:n}){const{locale:t,zIndex:s,ns:a,size:l}=je("message-box",b(()=>e.buttonSize)),{t:i}=t,{nextZIndex:u}=s,d=P(!1),o=qe({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:ge(he),cancelButtonLoadingIcon:ge(he),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:u()}),w=b(()=>{const r=o.type;return{[a.bm("icon",r)]:r&&ye[r]}}),R=Be(),f=Be(),H=b(()=>o.icon||ye[o.type]||""),I=b(()=>!!o.message),p=P(),D=P(),B=P(),L=P(),U=P(),Q=b(()=>o.confirmButtonClass);le(()=>o.inputValue,async r=>{await K(),e.boxType==="prompt"&&r!==null&&T()},{immediate:!0}),le(()=>d.value,r=>{var h,A;r&&(e.boxType!=="prompt"&&(o.autofocus?B.value=(A=(h=U.value)==null?void 0:h.$el)!=null?A:p.value:B.value=p.value),o.zIndex=u()),e.boxType==="prompt"&&(r?K().then(()=>{var fe;L.value&&L.value.$el&&(o.autofocus?B.value=(fe=O())!=null?fe:p.value:B.value=p.value)}):(o.editorErrorMessage="",o.validateError=!1))});const x=b(()=>e.draggable),_=b(()=>e.overflow);sn(p,D,x,_),ke(async()=>{await K(),e.closeOnHashChange&&window.addEventListener("hashchange",M)}),Te(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",M)});function M(){d.value&&(d.value=!1,K(()=>{o.action&&n("action",o.action)}))}const Y=()=>{e.closeOnClickModal&&k(o.distinguishCancelAndClose?"close":"cancel")},W=Ae(Y),X=r=>{if(o.inputType!=="textarea")return r.preventDefault(),k("confirm")},k=r=>{var h;e.boxType==="prompt"&&r==="confirm"&&!T()||(o.action=r,o.beforeClose?(h=o.beforeClose)==null||h.call(o,r,o,M):M())},T=()=>{if(e.boxType==="prompt"){const r=o.inputPattern;if(r&&!r.test(o.inputValue||""))return o.editorErrorMessage=o.inputErrorMessage||i("el.messagebox.error"),o.validateError=!0,!1;const h=o.inputValidator;if(re(h)){const A=h(o.inputValue);if(A===!1)return o.editorErrorMessage=o.inputErrorMessage||i("el.messagebox.error"),o.validateError=!0,!1;if(ce(A))return o.editorErrorMessage=A,o.validateError=!0,!1}}return o.editorErrorMessage="",o.validateError=!1,!0},O=()=>{const r=L.value.$refs;return r.input||r.textarea},de=()=>{k("close")},Pe=()=>{e.closeOnPressEscape&&de()};return e.lockScroll&&an(d),{...Ge(o),ns:a,overlayEvent:W,visible:d,hasMessage:I,typeClass:w,contentId:R,inputId:f,btnSize:l,iconComponent:H,confirmButtonClasses:Q,rootRef:p,focusStartRef:B,headerRef:D,inputRef:L,confirmRef:U,doClose:M,handleClose:de,onCloseRequested:Pe,handleWrapperClick:Y,handleInputEnter:X,handleAction:k,t:i}}});function pn(e,n,t,s,a,l){const i=$("el-icon"),u=$("close"),d=$("el-input"),o=$("el-button"),w=$("el-focus-trap"),R=$("el-overlay");return m(),y(Ze,{name:"fade-in-linear",onAfterLeave:f=>e.$emit("vanish"),persisted:""},{default:v(()=>[ne(E(R,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:v(()=>[g("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:c(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[E(w,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:v(()=>[g("div",{ref:"rootRef",class:c([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:be(e.customStyle),tabindex:"-1",onClick:j(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(m(),oe("div",{key:0,ref:"headerRef",class:c([e.ns.e("header"),{"show-close":e.showClose}])},[g("div",{class:c(e.ns.e("title"))},[e.iconComponent&&e.center?(m(),y(i,{key:0,class:c([e.ns.e("status"),e.typeClass])},{default:v(()=>[(m(),y(q(e.iconComponent)))]),_:1},8,["class"])):z("v-if",!0),g("span",null,N(e.title),1)],2),e.showClose?(m(),oe("button",{key:0,type:"button",class:c(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:f=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:G(j(f=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[E(i,{class:c(e.ns.e("close"))},{default:v(()=>[E(u)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):z("v-if",!0)],2)):z("v-if",!0),g("div",{id:e.contentId,class:c(e.ns.e("content"))},[g("div",{class:c(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(m(),y(i,{key:0,class:c([e.ns.e("status"),e.typeClass])},{default:v(()=>[(m(),y(q(e.iconComponent)))]),_:1},8,["class"])):z("v-if",!0),e.hasMessage?(m(),oe("div",{key:1,class:c(e.ns.e("message"))},[ie(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(m(),y(q(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(m(),y(q(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:v(()=>[te(N(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):z("v-if",!0)],2),ne(g("div",{class:c(e.ns.e("input"))},[E(d,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":f=>e.inputValue=f,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:c({invalid:e.validateError}),onKeydown:G(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),g("div",{class:c(e.ns.e("errormsg")),style:be({visibility:e.editorErrorMessage?"visible":"hidden"})},N(e.editorErrorMessage),7)],2),[[se,e.showInput]])],10,["id"]),g("div",{class:c(e.ns.e("btns"))},[e.showCancelButton?(m(),y(o,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:c([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:f=>e.handleAction("cancel"),onKeydown:G(j(f=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:v(()=>[te(N(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):z("v-if",!0),ne(E(o,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:c([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:f=>e.handleAction("confirm"),onKeydown:G(j(f=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:v(()=>[te(N(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[se,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[se,e.visible]])]),_:3},8,["onAfterLeave"])}var vn=Ye(mn,[["render",pn],["__file","index.vue"]]);const F=new Map,gn=e=>{let n=document.body;return e.appendTo&&(ce(e.appendTo)&&(n=document.querySelector(e.appendTo)),Ee(e.appendTo)&&(n=e.appendTo),Ee(n)||(n=document.body)),n},hn=(e,n,t=null)=>{const s=E(vn,e,re(e.message)||Le(e.message)?{default:re(e.message)?e.message:()=>e.message}:null);return s.appContext=t,Oe(s,n),gn(e).appendChild(n.firstElementChild),s.component},yn=()=>document.createElement("div"),bn=(e,n)=>{const t=yn();e.onVanish=()=>{Oe(null,t),F.delete(a)},e.onAction=l=>{const i=F.get(a);let u;e.showInput?u={value:a.inputValue,action:l}:u=l,e.callback?e.callback(u,s.proxy):l==="cancel"||l==="close"?e.distinguishCancelAndClose&&l!=="cancel"?i.reject("close"):i.reject("cancel"):i.resolve(u)};const s=hn(e,t,n),a=s.proxy;for(const l in e)Ce(e,l)&&!Ce(a.$props,l)&&(a[l]=e[l]);return a.visible=!0,a};function V(e,n=null){if(!J)return Promise.reject();let t;return ce(e)||Le(e)?e={message:e}:t=e.callback,new Promise((s,a)=>{const l=bn(e,n??V._context);F.set(l,{options:e,callback:t,resolve:s,reject:a})})}const Cn=["alert","confirm","prompt"],En={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};Cn.forEach(e=>{V[e]=wn(e)});function wn(e){return(n,t,s,a)=>{let l="";return Je(t)?(s=t,l=""):Qe(t)?l="":l=t,V(Object.assign({title:l,message:n,type:"",...En[e]},s,{boxType:e}),a)}}V.close=()=>{F.forEach((e,n)=>{n.doClose()}),F.clear()};V._context=null;const C=V;C.install=e=>{C._context=e._context,e.config.globalProperties.$msgbox=C,e.config.globalProperties.$messageBox=C,e.config.globalProperties.$alert=C.alert,e.config.globalProperties.$confirm=C.confirm,e.config.globalProperties.$prompt=C.prompt};const On=C;export{On as E,fn as a,Ae as b,an as c,Ln as s,sn as u};
