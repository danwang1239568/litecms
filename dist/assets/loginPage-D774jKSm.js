import{$ as T,r as p,L as M,af as v,g as F,S as l,H as s,k as t,W as U,o as A,T as V,a7 as k,a9 as f,ag as L,ah as $,ai as I,a0 as q}from"./index-B14M_1DM.js";import{a as N,E as S}from"./el-form-item-ZncFmYZF.js";import{E as z}from"./el-button-BpVWOTvG.js";import{E as Z}from"./el-checkbox-DhWjVR1Z.js";import{E as H}from"./el-input-rxOn-7Vc.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as j}from"./index-X6Lf7U8J.js";import"./constants-AddMQYT0.js";import"./use-form-item-CxPVW2vE.js";import"./_baseClone-Cj_b_JaC.js";import"./_initCloneObject-DMdQNfhv.js";import"./index-r5W6hzzQ.js";import"./event-HEVJa2N9.js";import"./isEqual-mPDDR2lY.js";import"./vnode-DkLdoXsi.js";import"./focus-trap-BtfC9WiE.js";const D={class:"boxout"},G={class:"login"},J={class:"remenber"},K={class:"registe"},O={__name:"loginPage",setup(Q){const E=T(),x=U(),d=p(x.query.mode||"login");M(()=>{m.value.style.left=d.value==="registe"?"-100%":"0"});function g(){d.value==="login"?(d.value="registe",c.value.resetFields(),m.value.style.left="-100%"):(d.value="login",w.value.resetFields(),m.value.style.left="0")}const w=p(null),c=p(null),m=p(null),n=v({username:"",password:""}),a=v({username:"",password:"",rePassword:""}),_=v({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[a-zA-Z0-9]{6,10}$/,message:"必须为6-10位数字或字母",trigger:["blur"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^[a-zA-Z0-9]{6,10}$/,message:"必须为6-10位数字或字母",trigger:"blur"}],rePassword:[{validator:(o,e,u)=>{d.value==="registe"&&e!==a.password?u(new Error("两次输入的密码不一致")):u()},trigger:"blur"}]}),P=async()=>{await c.value.validate(),await $(a),f.success("注册成功");const o=a.username;g(),n.username=o},R=async()=>{try{await w.value.validate();const o=await I(n);E.setToken("Bearer "+o.data.token),f.success("登录成功"),setTimeout(()=>{q.replace("/")},100)}catch(o){console.log(o)}},B=async()=>{if(!n.username)return f.warning("请输入用户名");const{value:o}=await j.prompt("请输入你的邮箱","Tip",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/,inputErrorMessage:"Invalid Email"});await L({...n,email:o}),f({type:"success",message:"密码重置成功, 初始密码为六个1"})};return(o,e)=>{const u=H,i=S,C=Z,b=z,y=N;return A(),F("div",null,[l("div",{class:"bg",onClick:e[5]||(e[5]=(...r)=>o.testFn&&o.testFn(...r))},[l("div",D,[l("div",{class:"boxin",ref_key:"boxin",ref:m},[l("div",G,[e[7]||(e[7]=l("h3",{class:"title"},"登录",-1)),e[8]||(e[8]=l("br",null,null,-1)),s(y,{ref_key:"formRefL",ref:w,model:n,rules:_,"label-width":"auto"},{default:t(()=>[s(i,{prop:"username",label:"用户名"},{default:t(()=>[s(u,{modelValue:n.username,"onUpdate:modelValue":e[0]||(e[0]=r=>n.username=r),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password",label:"密码"},{default:t(()=>[s(u,{modelValue:n.password,"onUpdate:modelValue":e[1]||(e[1]=r=>n.password=r),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),s(i,null,{default:t(()=>[l("div",J,[s(C,{label:"记住我"}),l("p",{class:"resetPwd",onClick:B},"忘记密码")])]),_:1}),s(b,{onClick:V(R,["prevent"]),class:"btn",type:"primary",plain:!1},{default:t(()=>e[6]||(e[6]=[k("登录")])),_:1}),l("p",{onClick:g,class:"changeMode"},"注册→")]),_:1},8,["model","rules"])]),l("div",K,[e[10]||(e[10]=l("h3",{class:"title"},"注册",-1)),e[11]||(e[11]=l("br",null,null,-1)),s(y,{ref_key:"formRefR",ref:c,model:a,rules:_,"label-width":"auto"},{default:t(()=>[s(i,{prop:"username",label:"用户名"},{default:t(()=>[s(u,{modelValue:a.username,"onUpdate:modelValue":e[2]||(e[2]=r=>a.username=r),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password",label:"密码"},{default:t(()=>[s(u,{modelValue:a.password,"onUpdate:modelValue":e[3]||(e[3]=r=>a.password=r),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password",label:"确认密码"},{default:t(()=>[s(u,{modelValue:a.rePassword,"onUpdate:modelValue":e[4]||(e[4]=r=>a.rePassword=r),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),s(b,{onClick:V(P,["prevent"]),class:"btn",type:"primary",plain:!1},{default:t(()=>e[9]||(e[9]=[k("注册")])),_:1}),l("p",{onClick:g,class:"changeMode"},"←登录")]),_:1},8,["model","rules"])])],512)])])])}}},fe=W(O,[["__scopeId","data-v-e5d5a097"]]);export{fe as default};
